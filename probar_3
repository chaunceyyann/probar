#!/bin/ksh
####################################################################################
# Program name : Progress bar implementation
# Author : Chauncey Yan
# Revision : 0.3
####################################################################################

####################################################################################
# Var init
####################################################################################
bar="##################################################"
b="\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b"
i=0
if [[ -f lastNum ]];then
	read i < lastNum
fi
if [[ $i -gt $1 ]];then
	i=0
	echo
fi
((s=$1+1));
####################################################################################
# Function: update_bar
# update the bar by one index
####################################################################################
update_bar(){
	((index=($1)%101/2))
	printf $1 > lastNum
	printf "$b$1\% ""${bar:0:$index}"
}
####################################################################################
# run a loop until it reachs the count
####################################################################################
until [[ $i -eq $s ]];do	
	update_bar $i
	sleep 0.05
	((i=$i+1))
done

